# ì±•í„° 2 - í…ŒìŠ¤íŠ¸

ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ê³„ì† ë³€í™”í•¨, ì´ì— ë”°ë¥¸ ì „ëµ 2ê°€ì§€

1. í™•ì¥ê³¼ ë³€ê²½ì„ ê³ ë ¤í•œ ê°ì²´ì§€í–¥ ì„¤ê³„
2. ë‚´ ì½”ë“œì— ëŒ€í•œ í™•ì‹ ì„ ê°€ì§€ê²Œ í•˜ê³  ë³€í™”ì— ìœ ìš©í•˜ê²Œ ëŒ€ì²˜í•˜ëŠ” í…ŒìŠ¤íŠ¸ ê¸°ìˆ 

## 2.1 UserDaoTest ë‹¤ì‹œ ë³´ê¸°

### 2.1.1 í…ŒìŠ¤íŠ¸ì˜ ìœ ìš©ì„±

ì½”ë“œë¥¼ ë¦¬íŒ©í† ë§ í–ˆì„ ë•Œ ì´ê²Œ ì²˜ìŒê³¼ ë™ì¼í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•¨ì„ ë³´ì¥í•˜ëŠ” ë°©ë²•ì€ í…ŒìŠ¤íŠ¸ë°–ì— ì—†ìŒ

> ğŸ’¡ í…ŒìŠ¤íŠ¸ë€?<br>
ì½”ë“œê°€ ì˜ˆìƒí•˜ê³  ì˜ë„í–ˆë˜ ëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•´ì„œ ì½”ë“œë¥¼ í™•ì‹ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì‘ì—…
> 

### 2.1.2 UserDaoTestì˜ íŠ¹ì§•

main() ë©”ì†Œë“œë¡œ ì‘ì„±ëœ í…ŒìŠ¤íŠ¸

```jsx
public class UserDaoTest {
	public static void main(String[] args) throws SQLException { 
		ApplicationContext context = new GenericXmlApplicationContext( 
		"applicationContext.xml");
		UserDao dao = context.getBean("userDao", UserDao.class);

		User user = new User();
		user.setld("user");
		user.setName("ë°±ê¸°ì„ ");
		user.setPassword("married");

		dao.add(user);

		System.out.println(user.getId() + " ë“±ë¡ ì„±ê³µ");

		User user2 = dao.get(user.getId());
		System.out.printin(user2.getName());
		System.out.printin(user2.getPassword());

		System.out.println(user2.getld() + "ì¡°íšŒ ì„±ê³µ");
	}
}
```

- ìë°”ì—ì„œ ê°€ì¥ ì†ì‰½ê²Œ ì‹¤í–‰ ê°€ëŠ¥í•œ main() ë©”ì†Œë“œë¥¼ ì´ìš©í•œë‹¤.
- í…ŒìŠ¤íŠ¸í•  ëŒ€ìƒì¸ **UserDaoì˜ ì˜¤ë¸Œì íŠ¸ë¥¼ ê°€ì ¸ì™€** ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œë‹¤.
- í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•  ì…ë ¥ ê°’(User ì˜¤ë¸Œì íŠ¸)ì„ ì§ì ‘ ì½”ë“œì—ì„œ ë§Œë“¤ì–´ ë„£ì–´ì¤€ë‹¤.
- í…ŒìŠ¤íŠ¸ì˜ ê²°ê³¼ë¥¼ ì½˜ì†”ì— ì¶œë ¥í•´ì¤€ë‹¤.
- ê° ë‹¨ê³„ì˜ ì‘ì—…ì´ ì—ëŸ¬ ì—†ì´ ëë‚˜ë©´ ì½˜ì†”ì— ì„±ê³µ ë©”ì‹œì§€ë¡œ ì¶œë ¥í•´ì¤€ë‹¤.

<br>

**ì›¹ì„ í†µí•œ DAO í…ŒìŠ¤íŠ¸ ë°©ë²•ì˜ ë¬¸ì œì **

---

ë³´í†µ ì›¹ í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš©í•˜ëŠ” DAO í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•

- í…ŒìŠ¤íŠ¸ìš© ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„œë²„ì— ë°°ì¹˜í•œ ë’¤ ê°„ë‹¨í•œ ì…ë ¥ì„ í†µí•´
- User ì˜¤ë¸Œì íŠ¸ ë§Œë“¤ê³  UserDao í˜¸ì¶œ ê¸°ëŠ¥ ë§Œë“¤ì–´ì ¸ì•¼í•¨
- ê·¸ë¦¬ê³  ìƒì„±ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê¸°ëŠ¥ë„ ë§Œë“¤ì–´ì•¼í•¨

ë‹¨ì 

- DAOë§Œ í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ì€ë° ë‹¤ë¥¸ ì„œë¹„ìŠ¤, ì»¨íŠ¸ë¡¤ëŸ¬, JSP ë·° ë“± ë‹¤ë¥¸ ê¸°ëŠ¥ë“¤ì„ ì¶”ê°€ì ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼í•¨
- ë¬¸ì œ ë°œìƒ ì§€ì  ì°¾ê¸° ì–´ë ¤ì›€
- í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ì€ DAOê°€ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ê³³ì—ì„œ ì˜¤ë¥˜ ë°œìƒ ê°€ëŠ¥

<br>

**ì‘ì€ ë‹¨ìœ„ì˜ í…ŒìŠ¤íŠ¸**

---

í…ŒìŠ¤íŠ¸í•˜ëŠ” ëŒ€ìƒë§Œ ì§‘ì¤‘í•´ì„œ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²ƒì´ ë°”ëŒì§

> ğŸ’¡ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë€?
>
>**ì‘ì€ ë‹¨ìœ„**ì˜ ì½”ë“œì— ëŒ€í•´ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒ
>
>**ì‘ì€ ë‹¨ìœ„?**<br>
>**í•˜ë‚˜ì˜ ê´€ì‹¬**ì— ì§‘ì¤‘í•´ì„œ íš¨ìœ¨ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•  ë§Œí•œ ë²”ìœ„ì˜ ë‹¨ìœ„
> 

ë•Œë¡œëŠ” ê°ì¢… ê¸°ëŠ¥ì„ ë¬¶ì–´ì„œ í…ŒìŠ¤íŠ¸í•´ì•¼í•˜ëŠ” ìƒí™© ë°œìƒ

- ê° ê¸°ëŠ¥ì€ ì˜ ë™ì‘í•˜ë‚˜ ì‹¤ì œë¡œ ì—°ê²°í–ˆì„ ë•Œ ì˜ ë™ì‘í•´ì•¼ í•˜ê¸° ë•Œë¬¸

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ëŠ” ì´ìœ 

- ê°œë°œìê°€ ì„¤ê³„í•˜ê³  ë§Œë“  **ì½”ë“œê°€ ì›ë˜ ì˜ë„í•œ ëŒ€ë¡œ ë™ì‘**í•˜ëŠ”ì§€ë¥¼ **ê°œë°œì ìŠ¤ìŠ¤ë¡œ ë¹¨ë¦¬ í™•ì¸**ë°›ê¸° ìœ„í•´
- ê°œë°œì í…ŒìŠ¤íŠ¸, í”„ë¡œê·¸ë˜ë¨¸ í…ŒìŠ¤íŠ¸ë¼ê³ ë„ í•¨

í™•ì¸ì˜ ëŒ€ìƒê³¼ ì¡°ê±´ì´ ê°„ë‹¨í•˜ê³  ëª…í™•í•˜ë©´ ì¢‹ìŒ
<br><br>

**ìë™ìˆ˜í–‰ í…ŒìŠ¤íŠ¸ ì½”ë“œ**

---

UserDaoTest íŠ¹ì§•

- í…ŒìŠ¤íŠ¸ **ë°ì´í„°**ê°€ **ì½”ë“œë¥¼ í†µí•´** ì œê³µ
- í…ŒìŠ¤íŠ¸ **ì‘ì—…** ì—­ì‹œ **ì½”ë“œë¥¼ í†µí•´** ìë™ìœ¼ë¡œ ì‹¤í–‰

**í…ŒìŠ¤íŠ¸ëŠ” ìë™ìœ¼ë¡œ ìˆ˜í–‰ë˜ë„ë¡ ì½”ë“œë¡œ ë§Œë“¤ì–´ì§€ëŠ” ê²ƒì´ ì¤‘ìš”**

ìë™ ìˆ˜í–‰ í…ŒìŠ¤íŠ¸ ì¥ì 

- ìì£¼ ë°˜ë³µí•  ìˆ˜ ìˆìŒ
- ì–¸ì œë“ ì§€ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆìŒ

<br>

**ì§€ì†ì ì¸ ê°œì„ ê³¼ ì ì§„ì ì¸ ê°œë°œì„ ìœ„í•œ í…ŒìŠ¤íŠ¸**

---

í…ŒìŠ¤íŠ¸ ì¥ì 

- **ìƒˆë¡œìš´ ê¸°ëŠ¥**ë„ **ê¸°ëŒ€í•œ ëŒ€ë¡œ ë™ì‘**í•˜ëŠ”ì§€ í™•ì¸
- **ê¸°ì¡´ì— ë§Œë“¤ì–´ë’€ë˜ê¸°ëŠ¥ë“¤ì´** ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ëŠë¼ ìˆ˜ì •í•œ ì½”ë“œì— ì˜í–¥ì„ ë°›ì§€ ì•Šê³  **ì—¬ì „íˆ ì˜ ë™ì‘í•˜ëŠ”ì§€ë¥¼ í™•ì¸**

### 2.1.3 UserDaoTest ë¬¸ì œì 

1. ìˆ˜ë™ í™•ì¸ ì‘ì—…ì˜ ë²ˆê±°ë¡œì›€
    1. add, get ì •ë³´ ì¼ì¹˜ë¥¼ ëˆˆìœ¼ë¡œ í™•ì¸í•´ì•¼í•¨
2. ì‹¤í–‰ ì‘ì—…ì˜ ë²ˆê±°ë¡œì›€

## 2.2 UserDaoTest ê°œì„ 

### 2.2.1 í…ŒìŠ¤íŠ¸ ê²€ì¦ì˜ ìë™í™”

ì²« ë²ˆì§¸ ë¬¸ì œì ì¸ **í…ŒìŠ¤íŠ¸ ê²°ê³¼ì˜ ê²€ì¦ ë¶€ë¶„ì„ ì½”ë“œë¡œ** ë§Œë“¤ì–´ë³´ì.

addí•œ ì •ë³´, getí•œ ì •ë³´ê°€ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸

[ìˆ˜ì • ì „]

```jsx
System.out.printin(user2.getName());
System.out.println(user2.getPassword());
System.out.printin(user2.getld() + " ì¡°íšŒ ì„±ê³µ");
```

[ìˆ˜ì • í›„]

```jsx
if (!user.getName().equals(user2.getName())) {
	System.out.printin("í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ (name)");
}
else if (!user.getPassword().equals(user2.getPassword())) {
	System.out.printin("í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ (password)");
}
else {
	System.out.printin("ì¡°íšŒ í…ŒìŠ¤íŠ¸ ì„±ê³µ");
}
```

### 2.2.2 í…ŒìŠ¤íŠ¸ì˜ íš¨ìœ¨ì ì¸ ìˆ˜í–‰ê³¼ ê²°ê³¼ ê´€ë¦¬

í…ŒìŠ¤íŠ¸ê°€ ë§ì•„ì§€ë©´ ì´ë¥¼ ê´€ë¦¬í•˜ê³  ì‹œê°í™”í•´ì¤„ ë„êµ¬ê°€ í•„ìš”

**JUnit í…ŒìŠ¤íŠ¸ë¡œ ì „í™˜**

---

main ë©”ì†Œë“œë¥¼ JUnitìœ¼ë¡œ ì¬ì‘ì„±

**í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œ ì „í™˜**

---

```jsx
import org.junit.Testï¼›
public class UserDaoTest {
	// JUnitì—ê²Œ í…ŒìŠ¤íŠ¸ìš© ë©”ì†Œë“œì„ì„ ì•Œë ¤ì¤€ë‹¤.
	@Test // ------> JUnit í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œëŠ” ë°˜ë“œì‹œ publicìœ¼ë¡œ ì„ ì–¸ë¼ì•¼ í•œë‹¤.
	public void addAndGet() throws SQLException { 
		ApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");
		UserDao dao = context.getBean("userDao", UserDao.class);
	}
}
```

1. main() ëŒ€ì‹  ì¼ë°˜ ë©”ì†Œë“œë¡œ ë³€ê²½
2. public ê¶Œí•œ ë¶€ì—¬
3. @Test ì• ë…¸í…Œì´ì…˜ ì¶”ê°€

**ê²€ì¦ ì½”ë“œ ì „í™˜**

---

```jsx
[ê¸°ì¡´]
if(!user.getName().equals(user2.getName())) { ... }

[JUnit]
assertThat(user2.getNameO() is(user.getName()));
// isëŠ” ë§¤ì²˜ì˜ ì¼ì¢…ìœ¼ë¡œ equalsë¡œ ë¹„êµí•´ì£¼ëŠ” ê¸°ëŠ¥
```

[JUnit ì ìš© UserDaoTest]

```jsx
import static org.hamcrest.CoreMatchers.isï¼›
import static org.junit.Assert.assertThatï¼›

public class UserDaoTest {
	Â©Test
	public void addAndGet() throws SQLException {
		ApplicationContext context = new GenericXmlApplicationContext("applicationContext.xml");
		UserDao dao = context.getBean("userDao", UserDao.class);
		User user = new User();
		user.setld("gyumee");
		user.setName("ë°•ì„± ì² ");
		user.setPassword("springnol");

		dao.add(user);
		User user2 = dao.get(user.getld());
		assertThat(user2.getName(), is(user.getName()));
		assertThat(user2.getPassword(), is(user.getPassword()));
	}
}
```

**JUnit í…ŒìŠ¤íŠ¸ ì‹¤í–‰**

---

- JUnitCore í´ë˜ìŠ¤ì˜ main ë©”ì†Œë“œ í˜¸ì¶œ
    - ë©”ì†Œë“œ íŒŒë¼ë¯¸í„°ì—ëŠ” @Test í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œë¥¼ ê°€ì§„ í´ë˜ìŠ¤ì˜ ì´ë¦„

```jsx
import org.junit.runner.JUnitCore;
public static void main(String[] args) {
	JUnitCore.main("springbook.user.dao.UserDaoTest");
}
```

## 2.3 ê°œë°œìë¥¼ ìœ„í•œ í…ŒìŠ¤íŒ… í”„ë ˆì„ì›Œí¬ JUnit

### 2.3.1 JUnit í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë°©ë²•

### 2.3.2 í…ŒìŠ¤íŠ¸ ê²°ê³¼ì˜ ì¼ê´€ì„±

ë¶ˆí¸í•œì 

- í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ DBì˜ USER í…Œì´ë¸” ë°ì´í„°ë¥¼ ëª¨ë‘ ì‚­ì œí•´ì¤˜ì•¼ í•¨

ì½”ë“œì— ë³€ê²½ì‚¬í•­ì´ ì—†ë‹¤ë©´ í…ŒìŠ¤íŠ¸ëŠ” í•­ìƒ ë™ì¼í•œ ê²°ê³¼ë¥¼ ë‚´ì•¼ í•¨

UserDaoTestì—ì„œ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ í›„ DB ì •ë³´ë¥¼ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ ì¶”ê°€

<br>

**deleteAll(), getCount() ì¶”ê°€**

---

**deleteAll()**

- USER í…Œì´ë¸” ëª¨ë“  ë ˆì½”ë“œ ì‚­ì œ ê¸°ëŠ¥

```jsx
public void deleteAll() throws SQLException {
	Connection c = dataSource.getConnection();
	PreparedStatement ps = c.prepareStatement("delete from users");
	ps.executellpdate();
	ps.close();
	c.close();
}
```

**getCount()**

- USER í…Œì´ë¸” ë ˆì½”ë“œ ê°œìˆ˜ ë°˜í™˜

```jsx
public int getCount() throws SQLException {
	Connection c = dataSource.getConnection();
	PreparedStatement ps = c.prepareStatement("select count(*) from users");
	ResultSet rs = ps.executeQuery();
	rs.next();
	int count = rs.getlnt(1);
	rs.close();
	ps.close();
	c.close();
	return count;
}
```

**deleteAll()ê³¼ getCount() í…ŒìŠ¤íŠ¸**

---

ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›€

ê¸°ì¡´ì˜ addAndGet() í…ŒìŠ¤íŠ¸ í™•ì¥

deleteAll()ì„ í•œ í›„ getCount()ë¥¼ í–ˆì„ ë•Œ 0ì´ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸

- í•˜ì§€ë§Œ getCount()ê°€ ì‹ ë¢° ë¶ˆê°€ëŠ¥
- addìˆ˜í–‰ í›„ getCount()ë¥¼ í•˜ì—¬ 1ì´ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸!

[deleteAll(), getCount() ì¶”ê°€ëœ addAndGet() í…ŒìŠ¤íŠ¸]

```jsx
@Test
public void addAndGetO throws SQLException {
	dao.deleteAll();
	assertThat(dao.getCount(), is(0));

	User user = new User();
	user.setld("gyumee");
	user. setName("ë°•ì„± ì² ");
	user.setPassword("springnol");
	dao.add(user);
	assertThat(dao.getCount(), is(1));

	User user2 = dao.get(user.getId());

	assertThat(user2.getName(), is(user.getName()));
	assertThat(user2.getPassword(), is(user.getPassword()));
}
```

<br>

**ë™ì¼í•œ ê²°ê³¼ë¥¼ ë³´ì¥í•˜ëŠ” í…ŒìŠ¤íŠ¸**

---

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” í•­ìƒ ì¼ê´€ì„± ìˆëŠ” ê²°ê³¼ê°€ ë³´ì¥ë¼ì•¼ í•¨

í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ì „ê³¼ ì‹¤í–‰í•œ í›„ DBì˜ ìƒíƒœê°€ ë™ì¼í•´ì•¼í•¨

ìœ„ì™€ ê°™ì€ ê²½ìš°ëŠ” ë§Œì•½ ê¸°ì¡´ì— DBì— ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì „ë¶€ ì‚­ì œí•´ë²„ë¦¬ëŠ” ì°¸ì‚¬ê°€ ì¼ì–´ë‚  ìˆ˜ ìˆìŒ

### 2.3.3 í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸

í…ŒìŠ¤íŠ¸ë¥¼ ì•ˆ ë§Œë“œëŠ” ê±´ ìœ„í—˜

ì„±ì˜ ì—†ì´í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“œëŠ” ë°”ëŒì— ë¬¸ì œê°€ ìˆëŠ” ì½”ë“œì¸ë°ë„ í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ê²Œ ë§Œë“œëŠ” ê±´ ë” ìœ„í—˜

íŠ¹íˆ í•œ ê°€ì§€ ê²°ê³¼ë§Œ ê²€ì¦í•˜ê³  ë§ˆëŠ” ê²ƒì€ ìƒë‹¹íˆ ìœ„í—˜

<br>

**getCount() í…ŒìŠ¤íŠ¸**

---

ì—¬ëŸ¬ ê°œì˜ User ë“±ë¡ í›„ getCount() ê²°ê³¼ í™•ì¸

getCount()ë¥¼ ìœ„í•œ ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œ ì‘ì„±

ì‹œë‚˜ë¦¬ì˜¤

1. USER í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ëª¨ë‘ ì§€ìš°ê³  getCount() ê²°ê³¼ê°€ 0ì„ í™•ì¸
2. 3ê°œ ì‚¬ìš©ì ì •ë³´ ì¶”ê°€í•  ë•Œ ë§ˆë‹¤ getCount()ê²°ê³¼ê°€ í•˜ë‚˜ì”© ì¦ê°€í•˜ëŠ”ì§€ í™•ì¸

[ í…ŒìŠ¤íŠ¸ ìš©ì´ì„±ì„ ìœ„í•œ íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” ìƒì„±ì ì¶”ê°€ ]

```jsx
public User(String id. String name, String password) {
	this.id = id;
	this.name = name;
	this.password = password;
}

public User() {}
```

[ getCount() í…ŒìŠ¤íŠ¸ ]

```jsx
@Test
public void count() throws SQLException {
	ApplicationContext context = new GenericXmlApplicationContext (
	"applicationContext.xml");
	
	UserDao dao = context.getBean("userDao", UserDao.class);
	User userl = new User("gyumee", "ë°•ì„±ì² ", "springnol");
	User user2 = new User("leegw700", "ì´ê¸¸ì›", "springno2");
	User user3 = new User("bumjin", "ë°•ë²”ì§„", "springno3");
	
	dao.deleteAll();
	assertThat(dao.getCount(), is(0));
	
	dao.add(user1);
	assertThat(dao.getCount()z is(1));
	
	dao.add(user2);
	assertThat(dao.getCount(), is(2));
	
	dao.add(user3)ï¼›
	assertThat(dao.getCount(), is(3));
}
```

JUnit ì‹¤í–‰ì‹œ í…ŒìŠ¤íŠ¸ë“¤ì´ ì–´ë–¤ ìˆœì„œë¡œ ì‹¤í–‰ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìŒ

**í…ŒìŠ¤íŠ¸ì˜ ê²°ê³¼ê°€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìˆœì„œì— ì˜í–¥ì„ ë°›ëŠ”ë‹¤ë©´ í…ŒìŠ¤íŠ¸ë¥¼ ì˜ëª» ë§Œë“  ê²ƒ**

<br>

**addAndGet() í…ŒìŠ¤íŠ¸ ë³´ì™„**

---

add()ì˜ ê¸°ëŠ¥ì€ ê²€ì¦ë˜ì—ˆì§€ë§Œ get()ì˜ ê¸°ëŠ¥ì€ ì™„ì „íˆ ê²€ì¦ë˜ì§€ ì•ŠìŒ

ë‘ ê°œì˜ User add í›„ ê° User idë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•´ì„œ ë™ì¼ì„± í™•ì¸

[ get() í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥ì„ ë³´ì™„í•œ addAndGet() í…ŒìŠ¤íŠ¸ ]

```jsx
Â©Test
public void addAndGet() throws SQLException {
	UserDao dao = context.getBean("userDao", UserDao.class);

  // ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ê°’ì„ ê°€ì§„ ë‘ ê°œì˜ user ì˜¤ë¸Œì íŠ¸ë¥¼ì¤€ë¹„í•´ë‘”ë‹¤
	User user1 = new User("gyumee", "ë°•ì„±ì² ", "springnol");
	User user2 = new User("leegw700", "ì´ê¸¸ì›", "springnoZ");
	dao.deleteAll(); 
	assertThat(dao.getCount(), is(0));

	dao.add(user1);
	dao.add(user2);
	assertThat(dao.getCount(), is(2));

	User userget1 = dao.get(user1 .getld());
	assertThat(userget1.getName(), is(user1 .getName()));
	assertThat(userget1.getPassword(), is(user1 .getPassword()));

	User userget2 = dao.get(user2.getld());
	assertThat(userget2.getName(), is(user2.getName()));
	assertThat(userget2.getPassword(), is(user2.getPassword()));
}
```

<br>

**get() ì˜ˆì™¸ì¡°ê±´ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸**

---

idì— í•´ë‹¹í•˜ëŠ” ì‚¬ìš©ì ì •ë³´ê°€ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬

- idì— í•´ë‹¹í•˜ëŠ” ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ë‹¤ëŠ” **ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ” ê²ƒìœ¼ë¡œ ì²˜ë¦¬**

[ get() ë©”ì†Œë“œì˜ ì˜ˆì™¸ìƒí™©ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ]

```jsx
@Test(expected=EmptyResultDataAccessException.class) // ë°œìƒ í•  ê²ƒìœ¼ë¡œ ê¸°ëŒ€í•˜ëŠ” ì˜ˆì™¸ í´ë˜ìŠ¤ë¥¼ ì§€ì •í•´ì¤Œ
public void getUserFailure() throws SQLException { 
	ApplicationContext context = new GenericXmlApplicationContext (
	"applicationContext.xml");

	UserDao dao = context.getBean("userDao", UserDao.class);
	dao.deleteAll();
	assertThat(dao.getCount(), is(0));

	dao.get("unknown_id");// ì´ ë©”ì†Œë“œ ì‹¤í–‰ ì¤‘ì— ì˜ˆì™¸ê°€ ë°œìƒí•´ì•¼ í•œë‹¤. 
												// ì˜ˆì™¸ê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•œë‹¤.
}
```

- **ìœ„ì˜ ê²½ìš°ëŠ” JUnit4ê¹Œì§€ëŠ” ë˜ì§€ë§Œ JUnit5ì—ì„œëŠ” ë©”ì†Œë“œë¥¼ í†µí•´ í•˜ëŠ” ê²ƒìœ¼ë¡œ ê¸°ì–µ!!**
- ì•„ì§ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ì‹¤íŒ¨í•¨
    - daoì—ì„œ rs.next()ë¥¼ í•  ë•Œ ì•„ë¬´ëŸ° rowë„ ì—†ìœ¼ë¯€ë¡œ SQLExceptionì„ ë°œìƒì‹œí‚¤ê¸° ë•Œë¬¸

<br>

**í…ŒìŠ¤íŠ¸ë¥¼ ì„±ê³µì‹œí‚¤ê¸° ìœ„í•œ ì½”ë“œì˜ ìˆ˜ì •**

---

[ ë°ì´í„°ë¥¼ ì°¾ì§€ ëª»í•˜ë©´ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ë„ë¡ ìˆ˜ì •í•œ get() ë©”ì†Œë“œ ]

```jsx
public User get(String id) throws SQLException {
	ResultSet rs = ps.executeQuery();
	User user = null; // â€”> UserëŠ” null ìƒíƒœë¡œ ì´ˆê¸°íˆí•´ëŠëŠ”ë‹¤.
	if (rs.next()) {
		// idë¥¼ ì¡°ê±´ìœ¼ë¡œ í•œ ì¿¼ë¦¬ì˜ ê²°ê³¼ê°€ ìˆìœ¼ë©´ User ì˜¤ë¸Œì íŠ¸ë¥¼ë§Œë“¤ê³  ê°’ì„ ë„£ì–´ì¤€ë‹¤.
		user = new User()ï¼›
		user.setld(rs.getString("id"))ï¼›
		user.setName(rs.getString("name"))ï¼›
		user.setPassword(rs.getString("password"))ï¼›
	}

	rs.close();
	ps.close();
	c.close(); 

	// ê²°ê³¼ê°€ ì—†ìœ¼ë©´ UserëŠ” null ìƒíƒœ ê·¸ëŒ€ë¡œì¼ ê²ƒì´ë‹¤.ì´ë¥¼ í™•ì¸í•´ì„œ ì˜ˆì™¸ë¥¼ ë˜ì ¸ì¤€ë‹¤.
	if (user == null) throw new EmptyResultDataAccessException(1)ï¼›
	return userï¼›
}
```

**í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸**

---

í…ŒìŠ¤íŠ¸ë¥¼ í•  ë• ì„±ê³µí•˜ëŠ” í…ŒìŠ¤íŠ¸ë§Œ ê³¨ë¼ì„œ ë§Œë“¤ì§€ ë§ ê²ƒ!

**ì˜ˆì™¸ì ì¸ í…ŒìŠ¤íŠ¸ë¥¼ í•­ìƒ ë¨¼ì € ìƒê°í•  ê²ƒ!**

> ğŸ‘¨ğŸ» ë¡œë“œ ì¡´ìŠ¨ (ìŠ¤í”„ë§ ì°½ì‹œì)
>
>â€œí•­ìƒ ë„¤ê±°í‹°ë¸Œ í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ë§Œë“¤ë¼â€
> 

### 2.3.4 í…ŒìŠ¤íŠ¸ê°€ ì´ë„ëŠ” ê°œë°œ

ì‘ì—… ìˆœì„œ

1. í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ë§Œë“¤ì–´ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ëŠ”ê²ƒì„ ë´„
2. UserDao ì½”ë“œ ìˆ˜ì •

ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ë„£ê¸° ìœ„í•´ UserDao ì½”ë“œ ìˆ˜ì •í•˜ê³  ê·¸ ì½”ë“œë¥¼ ê²€ì¦í•˜ê¸° ìœ„í•´ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì§€ ì•ŠìŒ

<br>

**ê¸°ëŠ¥ì„¤ê³„ë¥¼ ìœ„í•œ í…ŒìŠ¤íŠ¸**

---

â€œì¡´ì¬í•˜ì§€ ì•ŠëŠ” idë¡œ get() ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ë©´ íŠ¹ì •í•œ ì˜ˆì™¸ê°€ ë˜ì ¸ì ¸ì•¼ í•œë‹¤â€ëŠ” ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•  ê¸°ëŠ¥ì„ ê²°ì •

getUserFailure() í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ë§Œë“¦

**í…ŒìŠ¤íŠ¸í•  ì½”ë“œë„ ì—†ëŠ”ë° í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì—ˆë˜ ë°©ë²•**

- **ì¶”ê°€í•˜ê³  ì‹¶ì€ ê¸°ëŠ¥ì„ ì½”ë“œë¡œ í‘œí˜„**í•˜ë ¤ê³  í–ˆê¸° ë•Œë¬¸

getUserFailure()ì—ëŠ” ì¡°ê±´, í–‰ìœ„, ê²°ê³¼ì— ëŒ€í•œ ë‚´ìš©ì´ ì˜ í‘œí˜„

[ getUserFailure() í…ŒìŠ¤íŠ¸ ì½”ë“œì— ë‚˜íƒ€ë‚œ ê¸°ëŠ¥ ]

|  | ë‹¨ê³„ | ë‚´ìš© | ì½”ë“œ |
| --- | --- | --- | --- |
| ì¡°ê±´ (given) | ì–´ë–¤ ì¡°ê±´ì„ ê°€ì§€ê³  | ê°€ì ¸ì˜¬ ì‚¬ìš©ì ì •ë³´ì ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì— | dao.deleteAII( )ï¼›
assertThat(dao.getCount(), is(0))ï¼› |
| í–‰ìœ„ (when) | ë¬´ì—‡ì„ í•  ë•Œ | ì¡´ì¬í•˜ì§€ ì•ŠëŠ” idë¡œ get()ì„ ì‹¤í–‰í•˜ë©´ | get(â€unknown_idâ€); |
| ê²°ê³¼ (then) | ì–´ë–¤ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤ | íŠ¹ë³„í•œ ì˜ˆì™¸ê°€ ë˜ì ¸ì§„ë‹¤ | @Test(expected=
EmptyResultDataAccessException.class) |

í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ë§ˆì¹˜ ì„¤ê³„ë„ë¡œ ë³´ì„

í•´ë‹¹ ì„¤ê³„ë„ì— ë§ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•˜ì§€ ì•Šìœ¼ë©´ ê·¸ ì½”ë“œê°€ ì œëŒ€ë¡œ ëœ ì½”ë“œê°€ ì•„ë‹˜ì„ ì•Œ ìˆ˜ ìˆìŒ

<br>

**í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ**

---

> âš™ï¸ **í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ ( TDD - Test Driven Development )**
> 
> 
> ë§Œë“¤ê³ ì í•˜ëŠ” ê¸°ëŠ¥ì˜ ë‚´ìš©ì„ ë‹´ê³  ìˆìœ¼ë©´ì„œ ë§Œë“¤ì–´ì§„ ì½”ë“œë¥¼ ê²€ì¦ë„ í•´ì¤„ ìˆ˜ ìˆë„ë¡ **í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë¨¼ì € ë§Œë“¤ê³ **, í…ŒìŠ¤íŠ¸ë¥¼ ì„±ê³µí•˜ê²Œ í•´ì£¼ëŠ” **ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ë°©ì‹**ì˜ ê°œë°œ ë°©ë²•
> 
> **â€œì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì„±ê³µì‹œí‚¤ê¸° ìœ„í•œ ëª©ì ì´ ì•„ë‹Œ ì½”ë“œëŠ” ë§Œë“¤ì§€ ì•ŠëŠ”ë‹¤â€**
> 
> **í…ŒìŠ¤íŠ¸ ìš°ì„  ê°œë°œ** ( TFD - Test First Development ) ë¼ê³ ë„ í•¨
> 

TDD ì¥ì 

1. í…ŒìŠ¤íŠ¸ë¥¼ ë¹¼ë¨¹ì§€ ì•Šê³  ê¼¼ê¼¼í•˜ê²Œ ë§Œë“¤ì–´ë‚¼ ìˆ˜ ìˆë‹¤
2. ì½”ë“œë¥¼ ë§Œë“¤ì–´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ê·¸ ì‚¬ì´ ê°„ê²©ì´ ë§¤ìš° ì§§ìŒ
    1. ì½”ë“œì— ëŒ€í•œ í”¼ë“œë°±ì„ ë§¤ìš° ë¹ ë¥´ê²Œ ë°›ì„ ìˆ˜ ìˆìŒ

í…ŒìŠ¤íŠ¸ ì‘ì„±í•˜ê³  ì´ë¥¼ ì„±ê³µì‹œí‚¤ëŠ” ì½”ë“œë¥¼ ë§Œë“œëŠ” ì‘ì—…ì˜ ì£¼ê¸°ë¥¼ ê°€ëŠ¥
í•œ í•œ ì§§ê²Œ ê°€ì ¸ê°€ë„ë¡ ê¶Œì¥

í…ŒìŠ¤íŠ¸ëŠ” **ì½”ë“œë¥¼ ì‘ì„±í•œ í›„ì— ê°€ëŠ¥í•œ ë¹¨ë¦¬ ì‹¤í–‰**í•  ìˆ˜ ìˆì–´ì•¼ í•¨

í…ŒìŠ¤íŠ¸ì—†ì´ **í•œ ë²ˆì— ë„ˆë¬´ ë§ì€ ì½”ë“œë¥¼ ë§Œë“œëŠ” ê²ƒì€ ì¢‹ì§€ ì•ŠìŒ**

### 2.3.5 í…ŒìŠ¤íŠ¸ ì½”ë“œ ê°œì„ 

**@Before**

---

ë§¤ë²ˆ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì— ë¨¼ì € ì‹¤í–‰ì‹œì¼œì£¼ëŠ” ê¸°ëŠ¥

[ ì¤‘ë³µ ì½”ë“œë¥¼ ì œê±°í•œ UserDaoTest ]

```java
import org.junit.Before;

public class UserDaoTest {
	private UserDao dao;
	// setUp() ë©”ì†Œë“œì—ì„œ ë§Œë“œëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì—ì„œ
	// ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì„ ì–¸í•œë‹¤.
	@Before â€”> // JUnitì´ ì œê³µí•˜ëŠ” ì• ë…¸í…Œì´ì…˜. @Test ë©”ì†Œë“œê°€ ì‹¤í–‰ë˜ê¸°ì „ì— ë¨¼ì € ì‹¤í–‰ë¼ì•¼ í•˜ëŠ” ë©”ì†Œë“œë¥¼ ì •ì˜í•œë‹¤.
	public void setUp() {
		ApplicationContext context =
		new GenericXmlApplicationContext("applicationContext.xml")ï¼›
		this.dao = context.getBean("userDao", UserDao.class)ï¼›
	} 
	// ê° í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì— ë°˜ë³µì ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ë˜ ì½”ë“œë¥¼ ì œê±°í•˜ê³  ë³„ë„ì˜ ë©”ì†Œë“œë¡œ ì˜®ê¸´ë‹¤.

	@Test
	public void addAndGet() throws SQLException {
		...
	}

	@Test
	public void count() throws SQLException {
		...
	}

	@Test(expected=EmptyResultDataAccessException.class)
	public void getUserFailure() throws SQLException {
		...
	}
}
```

JUnitì´ í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë¥¼ ê°€ì ¸ì™€ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹

1. í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì—ì„œ @Testê°€ ë¶™ì€ publicì´ê³  voidí˜•ì´ë©° íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œë¥¼ ëª¨ë‘ ì°¾ëŠ”ë‹¤.
2. **í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì˜ ì˜¤ë¸Œì íŠ¸ë¥¼ í•˜ë‚˜ ë§Œë“ ë‹¤.**
    1. ê° í…ŒìŠ¤íŠ¸ê°€ ì„œë¡œ ì˜í–¥ì„ ì£¼ì§€ ì•Šê³  ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë¨ì„
    í™•ì‹¤íˆ ë³´ì¥í•´ì£¼ê¸° ìœ„í•´
3. @Beforeê°€ ë¶™ì€ ë©”ì†Œë“œê°€ ìˆìœ¼ë©´ ì‹¤í–‰í•œë‹¤.
4. @Testê°€ ë¶™ì€ ë©”ì†Œë“œë¥¼ í•˜ë‚˜ í˜¸ì¶œí•˜ê³  í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ì €ì¥í•´ë‘”ë‹¤.
5. @Afterê°€ ë¶™ì€ ë©”ì†Œë“œê°€ ìˆìœ¼ë©´ ì‹¤í–‰í•œë‹¤.
6. ë‚˜ë¨¸ì§€ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì— ëŒ€í•´ 2~5ë²ˆì„ ë°˜ë³µí•œë‹¤.
7. ëª¨ë“  í…ŒìŠ¤íŠ¸ì˜ ê²°ê³¼ë¥¼ ì¢…í•©í•´ì„œ ëŒë ¤ì¤€ë‹¤.

**í”½ìŠ¤ì²˜**

---

> ğŸ”¶ í”½ìŠ¤ì²˜

í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë° í•„ìš”í•œ ì •ë³´ë‚˜ ì˜¤ë¸Œì íŠ¸
> 

UserDaoTestì—ì„œë¼ë©´ daoê°€ ëŒ€í‘œì ì¸ í”½ìŠ¤ì²˜

[ User í”½ìŠ¤ì²˜ë¥¼ ì ìš©í•œ UserDaoTest ]

```java
public class UserDaoTest {
	private UserDao dao;
	private User user1;
	private User user2;
	private User user3;

	@Before
	public void setUp() {
		this.user1 = new User("gyumee", "ë°•ì„±ì² ", "springnol");
		this.user2 = new User("leegw700", "ì´ê¸¸ì›", "springnoZ");
		this.user3 = new User("bumjin", "ë°•ë²”ì§„", "springno3");
	}
}
```

## 2.4 ìŠ¤í”„ë§ í…ŒìŠ¤íŠ¸ ì ìš©

@Before ë©”ì†Œë“œê°€ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œ ê°œìˆ˜ë§Œí¼ ë°˜ë³µ ë˜ë¯€ë¡œ **ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸** ë„ ê·¸ ê°œìˆ˜ë§Œí¼ ìƒì„±ë¨

- ë¹ˆì´ ë§ì•„ì§€ê³  ë³µì¡í•´ì§€ë©´ **ì»¨í…ìŠ¤íŠ¸ ìƒì„± ë¹„ìš©ì´ í´ ê²ƒ**

**ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ëŠ” í•œ ë²ˆë§Œ ë§Œë“¤ê³  ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ê°€ ê³µìœ í•´ì„œ ì‚¬ìš©í•´ë„ ë¨**

@BeforeClass ìŠ¤íƒœí‹± ë©”ì†Œë“œ

- í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì „ì²´ì— ê±¸ì³ ë”± í•œë²ˆë§Œ ì‹¤í–‰

### 2.4.1 í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬

**ìŠ¤í”„ë§ í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ì ìš©**

---

[ ìŠ¤í”„ë§ í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì ìš©í•œ UserDaoTest ]

```jsx
@RunWith(SpringJUnit4ClassRunner.class)â€”> // ìŠ¤í”„ë§ì˜ í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì˜JUnit í™•ì¥ê¸°ëŠ¥ ì§€ì •
@ContextConfiguration(locations="/applicationContext.xml") // í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ê°€ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì˜ ì„¤ì •íŒŒì¼ ìœ„ì¹˜ë¥¼ ì§€ì •
public class UserDaoTest {
  @Autowired
	private ApplicationContext context;
	// í…ŒìŠ¤íŠ¸ ì˜¤ë¸Œì íŠ¸ê°€ ë§Œë“¤ì–´ì§€ê³  ë‚˜ë©´ ìŠ¤í”„ë§ í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ì— ì˜í•´ ìë™ìœ¼ë¡œ ê°’ì´ ì£¼ì…ëœë‹¤.

	Â©Before
	public void setUp() {
		this.dao = this.context.getBean("userDao",UserDao.class);
	}
}
```
<br>

**í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì˜ ì»¨í…ìŠ¤íŠ¸ ê³µìœ **

---

í…ŒìŠ¤íŠ¸ ì˜¤ë¸Œì íŠ¸ê°€ ì—¬ëŸ¬ê°œ ìƒì„±ë˜ì–´ë„ **ì»¨í…ìŠ¤íŠ¸ëŠ” 1ê°œë§Œ ìƒì„±**
<br><br>

**í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì˜ ì»¨í…ìŠ¤íŠ¸ ê³µìœ **

---

ëª¨ë‘ ê°™ì€ ì„¤ì •íŒŒì¼ì„ ê°€ì§„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤ë©´. ìŠ¤í”„ë§ì€ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ ì‚¬ì´ì—ì„œë„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê³µìœ 

**@Autowired**

---

ìŠ¤í”„ë§ì˜ DIì— ì‚¬ìš©ë˜ëŠ” íŠ¹ë³„í•œ ì• ë…¸í…Œì´ì…˜

ë°©ì‹

1. í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ëŠ” **ë³€ìˆ˜ íƒ€ì…ê³¼ ì¼ì¹˜**í•˜ëŠ” ì»¨í…ìŠ¤íŠ¸ ë‚´ì˜ ë¹ˆ ì°¾ìŒ
2. íƒ€ì…ì´ ì¼ì¹˜í•˜ëŠ” ë¹ˆì´ ìˆìœ¼ë©´ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì— ì£¼ì…

**ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ëŠ” ì´ˆê¸°í™”í•  ë•Œ ìê¸° ìì‹ ë„ ë¹ˆìœ¼ë¡œ ë“±ë¡**

ìŠ¤í”„ë§ DIë¥¼ ì‚¬ìš©í•˜ì—¬ daoë¥¼ ë°”ë¡œ ì£¼ì…ë°›ì„ ìˆ˜ë„ ìˆìŒ

```jsx
public class UserDaoTest {
	@Autowired
	UserDao dao;
	...
}
```

íƒ€ì…ìœ¼ë¡œ ê°€ì ¸ì˜¬ ë¹ˆ í•˜ë‚˜ë¥¼ ì„ íƒí•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ëŠ” ë³€ìˆ˜ì˜ ì´ë¦„ê³¼ ê°™ì€ ì´ë¦„ì˜ ë¹ˆì´ ìˆëŠ”ì§€ í™•ì¸

### 2.4.2 DIì™€ í…ŒìŠ¤íŠ¸

ì¸í„°í˜ì´ìŠ¤ë¥¼ ë‘ê³  ì´ë¥¼ ì ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ 

1. ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œì—ì„œ ì ˆëŒ€ë¡œ ë°”ë€Œì§€ ì•ŠëŠ” ê²ƒì€ ì—†ê¸° ë•Œë¬¸
2. í´ë˜ìŠ¤ì˜ êµ¬í˜„ ë°©ì‹ì€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤ í•˜ë”ë¼ë„ ë‹¤ë¥¸ ì°¨ì›ì˜ ì„œë¹„ìŠ¤ ê¸°ëŠ¥ ë„ì… ê°€ëŠ¥
3. í…ŒìŠ¤íŠ¸

<br>

**í…ŒìŠ¤íŠ¸ ì½”ë“œì— ì˜í•œ DI**

---

ì˜¤ë¸Œì íŠ¸ë¥¼ í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ ë³€ê²½í•  ìˆ˜ ìˆìŒ

- í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œ DIë¥¼ í†µí•´ ì˜ì¡´ ì˜¤ë¸Œì íŠ¸ ë³€ê²½ ê°€ëŠ¥

ë§Œì•½ í…ŒìŠ¤íŠ¸í• ë•Œ ê¸°ì¡´ ìš´ìš© ì„œë²„ì˜ DBë¥¼ ì‚¬ìš©í•œë‹¤ë©´?

- deleteAll ë•Œë¬¸ì— ì •ë³´ ì‚­ì œ â†’ ìœ„í—˜

ê·¸ë ‡ë‹¤ê³  ì„¤ì •íŒŒì¼ì—ì„œ DBë¥¼ ë°”ê¾¸ë©´?

- ë‹¤ì‹œ ì„œë²„ ì‹¤í–‰í•  ë•Œ DB ë°”ê¿”ì£¼ëŠ” ë²ˆê±°ë¡œì›€ ë°œìƒ

â‡’ DIë¡œ ì˜ì¡´ ì˜¤ë¸Œì íŠ¸ ë³€ê²½!!

[ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ìˆ˜ë™ ì´ë¥¼ ì ìš©í•œ UserDaoTest ]

```jsx
@DirtiesContext // í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì˜ êµ¬ì„±ì´ë‚˜ ìƒíƒœë¥¼ ë³€ê²½í•œë‹¤ëŠ” ê²ƒì„ í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì— ì•Œë ¤ì¤€ë‹¤.
public class UserDaoTest {
	@Autowired
	UserDao dao;
	
	@Before
	public void setUp() {
		// í…ŒìŠ¤íŠ¸ì—ì„œ UserDaoê°€ ì‚¬ìš©í•  DataSource ì˜¤ë¸Œì íŠ¸ë¥¼ ì§ì ‘ ìƒì„±í•œë‹¤
		DataSource dataSource = new SingleConnectionDataSource(
		"jdbc:mysql://localhost/testdb", "spring", "book", true);

		dao.setDataSource(dataSource); // ìˆ˜ë™ DI
	}
}
```

- ì„¤ì •íŒŒì¼ ìˆ˜ì • ì—†ì´ ì˜¤ë¸Œì íŠ¸ ê´€ê³„ ì¬êµ¬ì„± ê°€ëŠ¥

í•˜ì§€ë§Œ ë§¤ìš° ì£¼ì˜í•´ì„œ ì‚¬ìš©í•´ì•¼í•¨

- ì˜ì¡´ê´€ê³„ ê°•ì œ ë³€ê²½
- ëª¨ë“  í…ŒìŠ¤íŠ¸ì—ì„œ ê³µìœ 
    - ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì—ì„œë„ ë³€ê²½ëœ ì»¨í…ìŠ¤íŠ¸ê°€ ì‚¬ìš©ë¨
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±, ìƒíƒœë¥¼ í…ŒìŠ¤íŠ¸ ë‚´ì—ì„œ ë³€ê²½í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì›ì¹™

@DirtiesContext

- ë³€ê²½í•œ ì»¨í…ìŠ¤íŠ¸ê°€ ë’¤ì˜ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŒ
- ë§¤ë²ˆ ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë§Œë“¦

<br>

**í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ë³„ë„ì˜ DI ì„¤ì •**

---

í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©ë  DataSource í´ë˜ìŠ¤ê°€ ë¹ˆìœ¼ë¡œ ì •ì˜ëœ í…ŒìŠ¤íŠ¸ ì „ìš© ì„¤ì •íŒŒì¼ì„ ë”°ë¡œ ë§Œë“¤ì–´ë‘ëŠ” ë°©ë²•

ì¦‰, ìš´ì˜ìš©, í…ŒìŠ¤íŠ¸ìš© ì„¤ì •íŒŒì¼ ì´ 2ê°œë¥¼ ë§Œë“œëŠ” ê²ƒ
<br><br>

**ì»¨í…Œì´ë„ˆ ì—†ëŠ” DI í…ŒìŠ¤íŠ¸**

---

ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“œëŠ” ê²ƒ

[ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ì—†ëŠ” DI í…ŒìŠ¤íŠ¸ ]

 

```java
public class UserDaoTest {
	UserDao dao; // @Autowiredê°€ ì—†ë‹¤.
	@Before
	public void setUp() {
		dao = new UserDao();
		DataSource dataSource = new SingleConnectionDataSource(
		"jdbcï¼šmysqlï¼š//localhost/testdb", "spring", "book", true);
		dao.setDataSource(dataSource); // ì˜¤ë¸Œì íŠ¸ ìƒì„±, ê´€ê³„ì„¤ì • ë“±ì„ ëª¨ë‘ ì§ì ‘ í•´ì¤€ë‹¤.	
	}
}
```
<br>

**DIë¥¼ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ ë°©ë²• ì„ íƒ**

---

1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì—†ì´ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ë°©ë²• ìš°ì„ 
2. ì—¬ëŸ¬ ì˜¤ë¸Œì íŠ¸ì™€ ë³µì¡í•œ ì˜ì¡´ê´€ê³„ ì˜¤ë¸Œì íŠ¸ í…ŒìŠ¤íŠ¸ 
    
    â†’ ìŠ¤í”„ë§ ì„¤ì •ì„ í†µí•œ DI
    
3. ì˜ˆì™¸ì ì¸ ì˜ì¡´ê´€ê³„ë¥¼ ê°•ì œë¡œ êµ¬ì„±í•´ì„œ í…ŒìŠ¤íŠ¸í•´ì•¼ í•  ê²½ìš°
    
    â†’ ìˆ˜ë™ DI í•´ì„œ í…ŒìŠ¤íŠ¸
    

## 2.5 í•™ìŠµ í…ŒìŠ¤íŠ¸ë¡œ ë°°ìš°ëŠ” ìŠ¤í”„ë§

> ğŸ”¶ í•™ìŠµ í…ŒìŠ¤íŠ¸
> 
> 
> ìì‹ ì´ ë§Œë“¤ì§€ ì•Šì€ í”„ë ˆì„ì›Œí¬ë‚˜ ë‹¤ë¥¸ê°œë°œíŒ€ì—ì„œ ë§Œë“¤ì–´ì„œ ì œê³µí•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì— ëŒ€í•´ì„œë„ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±
> 

í•™ìŠµ í…ŒìŠ¤íŠ¸ ëª©ì 

- ìì‹ ì´ ì‚¬ìš©í•  APIë‚˜ í”„ë ˆì„ì›Œí¬ ì‚¬ìš© ë°©ë²• ìµíˆê¸° ìœ„í•´

### 2.5.1 í•™ìŠµ í…ŒìŠ¤íŠ¸ì˜ ì¥ì 

1. ë‹¤ì–‘í•œ ì¡°ê±´ì— ë”°ë¥¸ ê¸°ëŠ¥ì„ ì†ì‰½ê²Œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤
2. í•™ìŠµ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ê°œë°œ ì¤‘ì— ì°¸ê³ í•  ìˆ˜ ìˆë‹¤
3. í”„ë ˆì„ì›Œí¬ë‚˜ ì œí’ˆì„ ì—…ê·¸ë ˆì´ë“œí•  ë•Œ í˜¸í™˜ì„± ê²€ì¦ì„ ë„ì™€ì¤€ë‹¤
4. í…ŒìŠ¤íŠ¸ ì‘ì„±ì— ëŒ€í•œ ì¢‹ì€ í›ˆë ¨ì´ ëœë‹¤
5. ìƒˆë¡œìš´ ê¸°ìˆ ì„ ê³µë¶€í•˜ëŠ” ê³¼ì •ì´ ì¦ê±°ì›Œì§„ë‹¤

### 2.5.2 í•™ìŠµ í…ŒìŠ¤íŠ¸ ì˜ˆì œ

### 2.5.3 ë²„ê·¸ í…ŒìŠ¤íŠ¸

í•„ìš”ì„± ë° ì¥ì 

1. í…ŒìŠ¤íŠ¸ì˜ ì™„ì„±ë„ë¥¼ ë†’ì—¬ì¤€ë‹¤
2. ë²„ê·¸ì˜ ë‚´ìš©ì„ ëª…í™•í•˜ê²Œ ë¶„ì„í•˜ê²Œ í•´ì¤€ë‹¤
3. ê¸°ìˆ ì ì¸ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤

> **í…ŒìŠ¤íŠ¸ì˜ í•„ìš”ì„±ê³¼ ì‘ì„± ë°©ë²•**
> 
> 
> â€¢ í…ŒìŠ¤íŠ¸ëŠ” ìë™í™”ë¼ì•¼ í•˜ê³ . ë¹ ë¥´ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
> â€¢ main() í…ŒìŠ¤íŠ¸ ëŒ€ì‹  JUnit í”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ ì‘ì„±ì´ í¸ë¦¬í•˜ë‹¤.
> â€¢ í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” ì¼ê´€ì„±ì´ ìˆì–´ì•¼ í•œë‹¤. ì½”ë“œì˜ ë³€ê²½ ì—†ì´ í™˜ê²½ì´ë‚˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ìˆœì„œì— ë”°ë¼ì„œ ê²°ê³¼ê°€ ë‹¬ë¼ì§€ë©´ ì•ˆ ëœë‹¤.
> â€¢ í…ŒìŠ¤íŠ¸ëŠ” í¬ê´„ì ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•œë‹¤. ì¶©ë¶„í•œ ê²€ì¦ì„ í•˜ì§€ ì•ŠëŠ” í…ŒìŠ¤íŠ¸ëŠ” ì—†ëŠ” ê²ƒë³´ë‹¤ ë‚˜ì ìˆ˜ ìˆë‹¤.
> â€¢ ì½”ë“œ ì‘ì„±ê³¼ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ì˜ ê°„ê²©ì´ ì§§ì„ìˆ˜ë¡ íš¨ê³¼ì ì´ë‹¤.
> â€¢ í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰¬ìš´ ì½”ë“œê°€ ì¢‹ì€ ì½”ë“œë‹¤.
> â€¢ í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸ë¥¼ ì„±ê³µì‹œí‚¤ëŠ” ì½”ë“œë¥¼ ë§Œë“¤ì–´ê°€ëŠ” í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ ë°©ë²•ë„ ìœ ìš©í•˜ë‹¤.
> â€¢ í…ŒìŠ¤íŠ¸ ì½”ë“œë„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì ì ˆí•œ ë¦¬íŒ©í† ë§ì´ í•„ìš”í•˜ë‹¤.
> â€¢ @Before, @Afterë¥¼ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ ë©”ì†Œë“œë“¤ì˜ ê³µí†µ ì¤€ë¹„ ì‘ì—…ê³¼ ì •ë¦¬ ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ìˆë‹¤.
> â€¢ ìŠ¤í”„ë§ í…ŒìŠ¤íŠ¸ ì»¨í…ìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í•˜ë©´ í…ŒìŠ¤íŠ¸ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.
> â€¢ ë™ì¼í•œ ì„¤ì •íŒŒì¼ì„ ì‚¬ìš©í•˜ëŠ” í…ŒìŠ¤íŠ¸ëŠ” í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê³µìœ í•œë‹¤.
> â€¢ @Autowiredë¥¼ ì‚¬ìš©í•˜ë©´ ì»¨í…ìŠ¤íŠ¸ì˜ ë¹ˆì„ í…ŒìŠ¤íŠ¸ ì˜¤ë¸Œì íŠ¸ì— DI í•  ìˆ˜ ìˆë‹¤.
> â€¢ ê¸°ìˆ ì˜ ì‚¬ìš© ë°©ë²•ì„ ìµíˆê³  ì´í•´ë¥¼ ë•ê¸° ìœ„í•´ í•™ìŠµ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ì.
> â€¢ ì˜¤ë¥˜ê°€ ë°œê²¬ë  ê²½ìš° ê·¸ì— ëŒ€í•œ ë²„ê·¸ í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ë‘ë©´ ìœ ìš©í•˜ë‹¤
>
